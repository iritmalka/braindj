<html>
	<header>
		<link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
	    <script src="http://code.jquery.com/jquery-2.0.0.js"></script>
	    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
	    <style type="text/css">
	    	body {
	    		background: #E0EDEE;
	    	}
	    	.row {
	    		text-align: center;
	    	}

		    .progress {
				margin: 20px auto auto auto;
				width: 1150px;
			}

			.mood-button {
				margin: 50px auto;
				height: 200px;
				width: 200px;
				background-image: url(/static/Blow_Off.png);
			}
	    </style>
	</header>
	<body>
		<div class="row">
			<h2>Blur - Song #2</h2>
			<h4><b>Tolerance threshold:</b> 10 seconds</h4>
		</div>

		<div class="row">
			<div class="progress">
			  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100">
			    <span class="sr-only">60% Complete</span>
			  </div>
			</div>
		</div>

		<div class="row">
			<div class="col-xs-12 col-sm-4 button-holder">
				<button class="mood-button" onclick="set_state(0)">chill</button>
			</div>
			<div class="col-xs-12 col-sm-4 button-holder">
				<button class="mood-button" onclick="set_state(1)">curious</button>
			</div>
			<div class="col-xs-12 col-sm-4 button-holder">
				<button class="mood-button" onclick="set_state(2)">aweful</button>
			</div>
		</div>

		<div class="row">
			<img src="http://placehold.it/1150x150">
		</div>


		<script type="text/javascript">
			var chill = 33;
			var curious = 67;
			var suffer = 100

			function progress_color(likeness) {
				if (likeness <= chill) {
					return "progress-bar-success";
				} else if (likeness > curious) {
					return "progress-bar-danger";
				} else {
					return "progress-bar-warning";
				}
			}


			function set_state(mode) {

					$.ajax({
					    url: "http://localhost:8080/set_state?index=" + mode,
					    context: document.body,
					    success: function(data) {
					    }
					});
				};


			var ajax_call = function() {


					$.ajax({
					    url: "http://localhost:8080/current_likeness",
					    context: document.body,
					    success: function(data) {
					    	var progress_bar = $('.progress-bar');
					    	progress_bar.width(data["current_likeness"] + "%");
					    	
					    	progress_bar.removeClass(function (index, css) {
							    return (css.match (/\bprogress-bar-\S+/g) || []).join(' ');
							});
					    	progress_bar.addClass(progress_color(data["likeness"]));
					    }
					});
				};

			var interval = 1000; // every second

			setInterval(ajax_call, interval);
		</script>
	</body>
</html>

